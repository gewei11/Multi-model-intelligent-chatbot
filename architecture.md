# 项目架构图

## 分层架构图

```
+---------------------------+
|        应用层 (App)       |
|   Streamlit Web 界面      |
+---------------------------+
            |
            v
+---------------------------+
|      核心调度层 (Core)     |
|       CoreAgent           |
+---------------------------+
            |
            v
+-----------+-------------+
|                         |
|     功能性Agent层        |
|                         |
+-----+-----+-----+------+
      |     |     |      \
      v     v     v       v
+------+ +------+ +------+ +------+
|对话  | |天气  | |语音  | |领域  |
|Agent | |Agent | |Agent | |Agent |
+------+ +------+ +------+ +------+
   |        |        |        |
   v        v        v        v
+------+ +------+ +------+ +------+
|Qwen  | |天气  | |语音  | |情感  |
|模型  | |工具  | |工具  | |工具  |
+------+ +------+ +------+ +------+
```

## 模块关系图

```
+----------------+     +----------------+     +----------------+
|                |     |                |     |                |
|  应用层 (App)   +---->+  核心Agent     +---->+  功能性Agent   |
|                |     |  (CoreAgent)  |     |                |
+----------------+     +----------------+     +-------+--------+
                                                      |
                                                      v
                       +----------------+     +----------------+
                       |                |     |                |
                       |  工具层 (Tools) <-----+  模型层 (Models)|
                       |                |     |                |
                       +----------------+     +----------------+
                               ^
                               |
                       +----------------+
                       |                |
                       |  工具类 (Utils) |
                       |                |
                       +----------------+
```

## 主要模块说明

### 1. 应用层 (App)
- **streamlit_app.py**: Web界面实现，用户交互入口

### 2. 核心调度层 (Core)
- **core_agent.py**: 核心调度Agent，负责解析用户输入并路由到合适的子Agent

### 3. 功能性Agent层
- **conversation_agent.py**: 对话Agent，处理一般对话
- **weather_agent.py**: 天气Agent，处理天气查询
- **voice_agent.py**: 语音Agent，处理语音合成
- **sentiment_agent.py**: 情感Agent，分析情感
- **domain_agents/**: 领域特定Agent
  - **education_agent.py**: 教育领域Agent
  - **ecommerce_agent.py**: 电商领域Agent
  - **government_agent.py**: 政务领域Agent

### 4. 模型层 (Models)
- **qwen2_5.py**: 通义千问2.5模型接口
- **deepseek.py**: DeepSeek模型接口
- **minicpm.py**: MiniCPM模型接口

### 5. 工具层 (Tools)
- **weather_tools.py**: 天气查询工具
- **chattts_tools.py**: 语音合成工具
- **sentiment_tools.py**: 情感分析工具
- **drawing_tools.py**: 绘图工具

### 6. 工具类 (Utils)
- **logger.py**: 日志工具
- **config.py**: 配置管理
- **helper_functions.py**: 辅助函数

## 数据流向

1. 用户通过Streamlit界面输入请求
2. 请求传递给CoreAgent进行意图识别和路由
3. CoreAgent根据意图将请求分发给对应的功能性Agent
4. 功能性Agent调用相应的模型和工具处理请求
5. 处理结果返回给CoreAgent，再返回给用户界面显示

## 扩展性设计

系统采用模块化设计，便于扩展：
- 新增功能只需添加对应的Agent和工具
- 支持多种LLM模型接入
- 领域Agent可以独立开发和部署